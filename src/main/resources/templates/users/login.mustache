{{>layouts/header}}
<br><br><br>

<div class="form-group" align="center">
    <h3>ğŸ’‚ğŸ»â€â™€ï¸ ë¡œê·¸ì¸ ğŸ’‚ğŸ»â€â™‚ï¸</h3>
    <br>
    <div class="form-floating mb-3">
        <label for="floatingInput">íšŒì› ëª…</label>
        <input name="userName" type="text" class="form-control" id="input-userName" placeholder="íšŒì›ëª…ì„ ì…ë ¥í•˜ì„¸ìš”" style="width:300px;height:50px;">
    </div>
    <div class="form-floating">
        <label for="floatingPassword">ë¹„ë°€ë²ˆí˜¸</label>
        <input name="password" class="form-control" id="input-password" placeholder="ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”" style="width:300px;height:50px;">
    </div>

    <br>

    <button type="button" class="btn btn-primary" id="user-login-btn">ë¡œê·¸ì¸</button>
</div>


<Script>
    let user = {
        init: function () {

            var _this = this;

            const loginBtn = document.querySelector('#user-login-btn');

            loginBtn.addEventListener('click', _this.login);
        },


        login: function () {
            let data = {
                userName: document.querySelector('#input-userName').value.trim(),
                password: document.querySelector('#input-password').value.trim(),
            };
            console.log(data);
            if (data.userName == '') {
                alert('íšŒì›ëª…ì„ ì…ë ¥í•´ì£¼ì„¸ìš”');
                return;
            }
            if (data.password == '') {
                alert('ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”');
                return;
            }

            axios.post("/api/v1/users/login",
                    JSON.stringify(data), {
                        headers: {
                            'Content-Type': 'application/json'
                        }
                    }
            ).then((response) => {
                localStorage.setItem("token", response.data.result["jwt"]);
                alert("ë¡œê·¸ì¸ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤.");
                window.location.href = '/';
            }).catch((error) => {
                console.log(error.response.data.result["errorCode"])
                if (error.response.data.result["errorCode"] == "USERNAME_NOT_FOUND") {
                    alert("ê°€ì…ëœ íšŒì›ì´ ì•„ë‹™ë‹ˆë‹¤. íšŒì›ê°€ì… í›„ ë¡œê·¸ì¸ í•´ì£¼ì„¸ìš”");
                }else if(error.response.data.result["errorCode"]=="INVALID_PASSWORD"){
                    alert("ë¹„ë°€ë²ˆí˜¸ê°€ ì¼ì¹˜í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤. ë‹¤ì‹œ ì…ë ¥í•´ì£¼ì„¸ìš”");
                }

            });
        }
    };
    user.init();
</script>